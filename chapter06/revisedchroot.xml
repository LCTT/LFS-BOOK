<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
  "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../general.ent">
  %general-entities;
]>

<sect1 id="ch-system-revisedchroot">
  <?dbhtml filename="revisedchroot.html"?>

  <title>清理</title>

  <para>最后，清除运行测试留下来的多余文件：</para>

<screen><userinput>rm -rf /tmp/*</userinput></screen>

  <para>现在，登出后用以下新的 chroot 命令重新进入 chroot 环境。在此以后当需要进入 chroot 环境时，都是用这个新的 chroot 命令：</para>

<screen role="nodump"><userinput>logout

chroot "$LFS" /usr/bin/env -i          \
    HOME=/root TERM="$TERM"            \
    PS1='(lfs chroot) \u:\w\$ '        \
    PATH=/bin:/usr/bin:/sbin:/usr/sbin \
    /bin/bash --login</userinput></screen>

  <para>这样做的原因是不再需要 <filename class="directory">/tools</filename> 中的程序。因此你可以删除 <filename class="directory">/tools</filename> 目录。</para>

  <note>
    <para>移除 <filename class="directory">/tools</filename> 也会删除用于运行工具链测试的 Tcl、Expect和 DejaGNU 的临时复制。如果你在后面还需要这些程序，需要重新编译并安装它们。BLFS 手册有关于这些的指令（请查看<ulink url="&blfs-root;"/>）。</para>
  </note>

  <para>如果通过手动或者重启卸载了虚拟内核文件系统，重新进入 chroot 的时候确保挂载了虚拟内核文件系统。在 <xref linkend="ch-system-bindmount"/> 和 <xref linkend="ch-system-kernfsmount"/> 中介绍了该过程。</para>

  <para>还有一些此章之前为了一些软件包的回归测试而留下的静态库。这些库来自 binutils、bzip2、e2fsprogs、flex、libtool 和 zlib。如果想删的话，现在就删：</para>

<screen><userinput>rm -f /usr/lib/lib{bfd,opcodes}.a
rm -f /usr/lib/libbz2.a
rm -f /usr/lib/lib{com_err,e2p,ext2fs,ss}.a
rm -f /usr/lib/libltdl.a
rm -f /usr/lib/libfl.a
rm -f /usr/lib/libz.a</userinput></screen>

  <para>还有几个安装在 /usr/lib 和 /usr/libexec 目录下的文件，文件的扩展名为 .la。这些是「libtool 归档」文件，在 Linux 系统中通常不需要它们。这些都是没有必要的东西。想要删除的话，运行：</para>

<screen><userinput>find /usr/lib /usr/libexec -name \*.la -delete</userinput></screen>

   <para>关于 libtool 归档文件的更多信息，参考 <ulink url="&blfs-book;/introduction/la-files.html">BLFS 段落「关于 Libtool 归档（.la）文件」</ulink>。</para>

</sect1>
